{% extends "base-apply.html" %}
{% load render_table from django_tables2 %}
{% load static wagtailcore_tags %}

{% block extra_css %}
    {{ filter.form.media.css }}
{% endblock %}

{% block title %}OTF reviewer Dashboard{% endblock %}

{% block content %}
<div class="admin-bar">
    <div class="admin-bar__inner">
        {% block page_header %}
            <h1 class="gamma heading heading--no-margin heading--bold">Dashboard</h1>
        {% endblock %}
    </div>
</div>

<div class="wrapper wrapper--large wrapper--inner-space-medium">
    <div class="wrapper wrapper--large wrapper--inner-space-medium">

        <h4 class="heading heading--normal">
            Waiting for your review <span class="heading heading--submission-count">{{ in_review_count }}</span>
        </h4>

        {% if my_review.data %}
            {% render_table my_review %}

            {% if display_more %}
                <div class="all-submissions-table__more">
                    <a href="{% url 'apply:submissions:list' %}">Show all</a>
                </div>
            {% endif %}

        {% else %}
            <div class="grid grid--seventy-thirty wrapper wrapper--large ">
                <div class="reviewer-dash-box">
                    <h5 class="reviewer-dash-box__title">Nice! You're all caught up.</h5>
                    <a class="button button--primary" href="{% url 'apply:submissions:list' %}">Find new applications to review</a>
                </div>
                {# TODO Fill in data and update styles in future ticket #}
                <div>{# Since you last logged in #}</div>
            </div>
        {% endif %}
    </div>
</div>

<div class="wrapper wrapper--large wrapper--inner-space-medium">
    <div class="wrapper wrapper--large wrapper--inner-space-medium">

        {% if my_reviewed.data %}

            <h4 class="heading heading--normal">
                Previous reviews
            </h4>

            {% include "funds/includes/table_filter_and_search.html" with filter_form=filter_form search_term=search_term use_search=True %}
            {% render_table my_reviewed %}

            {% if display_more_reviewed %}
                <div class="all-submissions-table__more">
                    <a href="{% url 'apply:submissions:list' %}">Show all</a>
                </div>
            {% endif %}

        {% endif %}
    </div>
</div>

{% endblock %}

{% block extra_js %}
    {{ filter.form.media.js }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/url-search-params/1.1.0/url-search-params.js"></script>
    <script src="{% static 'js/apply/submission-filters.js' %}"></script>
    <script src="{% static 'js/apply/submission-tooltips.js' %}"></script>
{% endblock %}

