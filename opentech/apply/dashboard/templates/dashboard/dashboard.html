{% extends "base-apply.html" %}
{% load render_table from django_tables2 %}
{% load static %}

{% block extra_css %}
    {{ filter.form.media.css }}
{% endblock %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="admin-bar">
    <div class="admin-bar__inner admin-bar__inner--with-button">
        {% block page_header %}
            <h1 class="gamma heading heading--no-margin heading--bold">Dashboard</h1>
        {% endblock %}
        <a href="{% url 'wagtailadmin_home' %}" class="button button--primary button--arrow-pixels-white">
            Apply admin
            <svg><use xlink:href="#arrow-head-pixels--solid"></use></svg>
        </a>
    </div>
</div>
<div class="wrapper wrapper--large wrapper--inner-space-medium">
        <div class="wrapper wrapper--large wrapper--inner-space-medium">

            <h4 class="heading heading--normal">
                Waiting for your review <span class="heading heading--submission-count">{{ in_review_count }}</span>
            </h4>

            {% if my_review.data %}
                {% render_table my_review %}

                {% if display_more %}
                    <div class="all-submissions-table__more">
                        <a href="{% url 'apply:submissions:list' %}?reviewers={{ request.user.pk }}">Show all</a>
                    </div>
                {% endif %}

            {% else %}
                <div class="grid wrapper wrapper--large ">
                    <div class="reviewer-dash-box">
                        <h5 class="reviewer-dash-box__title">Nice! You're all caught up.</h5>
                        <a class="button button--primary" href="{% url 'apply:submissions:list' %}">Find new applications to review</a>
                    </div>
                    {# TODO Fill in data and update styles in future ticket #}
                    <div>{# Since you last logged in #}</div>
                </div>
            {% endif %}

            {% if closed_rounds or open_rounds %}
                {% include "funds/includes/round-block.html" with closed_rounds=closed_rounds open_rounds=open_rounds title=rounds_title %}
            {% endif %}

        </div>

        <div class="wrapper wrapper--large wrapper--inner-space-medium">
            {% if my_reviewed.data %}

                <h4 class="heading heading--normal">
                    Previous reviews
                </h4>

                {% include "funds/includes/table_filter_and_search.html" with filter_form=filter_form search_term=search_term use_search=True %}
                {% render_table my_reviewed %}

                {% if display_more_reviewed %}
                    <div class="all-submissions-table__more">
                        <a href="{% url 'apply:submissions:list' %}?reviewers={{ request.user.pk }}">Show all</a>
                    </div>
                {% endif %}

            {% endif %}
        </div>

</div>
{% endblock %}

{% block extra_js %}
    {{ filter.form.media.js }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/url-search-params/1.1.0/url-search-params.js"></script>
    <script src="{% static 'js/apply/submission-filters.js' %}"></script>
    <script src="{% static 'js/apply/submission-tooltips.js' %}"></script>
    <script src="{% static 'js/apply/tabs.js' %}"></script>
{% endblock %}
